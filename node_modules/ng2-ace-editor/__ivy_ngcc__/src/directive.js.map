{"version":3,"file":"directive.js","sources":["../../src/directive.ts"],"names":[],"mappings":"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","sourcesContent":["import { Directive, EventEmitter, Output, ElementRef, Input, OnInit, OnDestroy, NgZone } from \"@angular/core\";\r\nimport \"brace\";\r\nimport \"brace/theme/monokai\";\r\n\r\n\r\ndeclare var ace: any;\r\n\r\n@Directive({\r\n    selector: '[ace-editor]'\r\n})\r\nexport class AceEditorDirective implements OnInit, OnDestroy {\r\n    @Output() textChanged = new EventEmitter();\r\n    @Output() textChange = new EventEmitter();\r\n    _options: any = {};\r\n    _readOnly: boolean = false;\r\n    _theme: string = \"monokai\";\r\n    _mode: any = \"html\";\r\n    _autoUpdateContent: boolean = true;\r\n    _durationBeforeCallback: number = 0;\r\n    _text: string = \"\";\r\n    editor: any;\r\n    oldText: any;\r\n    timeoutSaving: any;\r\n\r\n    constructor(elementRef: ElementRef, private zone: NgZone) {\r\n        let el = elementRef.nativeElement;\r\n        this.zone.runOutsideAngular(() => {\r\n            this.editor = ace[\"edit\"](el);\r\n        });\r\n        this.editor.$blockScrolling = Infinity;\r\n    }\r\n\r\n    ngOnInit() {\r\n        this.init();\r\n        this.initEvents();\r\n    }\r\n\r\n    ngOnDestroy() {\r\n        this.editor.destroy();\r\n    }\r\n\r\n    init() {\r\n        this.editor.setOptions(this._options || {});\r\n        this.editor.setTheme(`ace/theme/${this._theme}`);\r\n        this.setMode(this._mode);\r\n        this.editor.setReadOnly(this._readOnly);\r\n    }\r\n\r\n    initEvents() {\r\n        this.editor.on('change', () => this.updateText());\r\n        this.editor.on('paste', () => this.updateText());\r\n    }\r\n\r\n    updateText() {\r\n        let newVal = this.editor.getValue();\r\n        if (newVal === this.oldText) {\r\n            return;\r\n        }\r\n        if (!this._durationBeforeCallback) {\r\n            this._text = newVal;\r\n            this.zone.run(() => {\r\n                this.textChange.emit(newVal);\r\n                this.textChanged.emit(newVal);\r\n            });\r\n        } else {\r\n            if (this.timeoutSaving != null) {\r\n                clearTimeout(this.timeoutSaving);\r\n            }\r\n\r\n            this.timeoutSaving = setTimeout(() => {\r\n                this._text = newVal;\r\n                this.zone.run(() => {\r\n                    this.textChange.emit(newVal);\r\n                    this.textChanged.emit(newVal);\r\n                });\r\n                this.timeoutSaving = null;\r\n            }, this._durationBeforeCallback);\r\n        }\r\n        this.oldText = newVal;\r\n    }\r\n\r\n    @Input() set options(options: any) {\r\n        this._options = options;\r\n        this.editor.setOptions(options || {});\r\n    }\r\n\r\n    @Input() set readOnly(readOnly: any) {\r\n        this._readOnly = readOnly;\r\n        this.editor.setReadOnly(readOnly);\r\n    }\r\n\r\n    @Input() set theme(theme: any) {\r\n        this._theme = theme;\r\n        this.editor.setTheme(`ace/theme/${theme}`);\r\n    }\r\n\r\n    @Input() set mode(mode: any) {\r\n        this.setMode(mode);\r\n    }\r\n\r\n    setMode(mode: any) {\r\n        this._mode = mode;\r\n        if (typeof this._mode === 'object') {\r\n            this.editor.getSession().setMode(this._mode);\r\n        } else {\r\n            this.editor.getSession().setMode(`ace/mode/${this._mode}`);\r\n        }\r\n    }\r\n\r\n    @Input()\r\n    get text() {\r\n        return this._text;\r\n    }\r\n\r\n    set text(text: string) {\r\n        this.setText(text);\r\n    }\r\n\r\n    setText(text: any) {\r\n        if (this._text !== text) {\r\n            if (text === null || text === undefined) {\r\n                text = \"\";\r\n            }\r\n\r\n            if (this._autoUpdateContent === true) {\r\n                this._text = text;\r\n                this.editor.setValue(text);\r\n                this.editor.clearSelection();\r\n            }\r\n        }\r\n    }\r\n\r\n    @Input() set autoUpdateContent(status: any) {\r\n        this._autoUpdateContent = status;\r\n    }\r\n\r\n    @Input() set durationBeforeCallback(num: number) {\r\n        this.setDurationBeforeCallback(num);\r\n    }\r\n\r\n    setDurationBeforeCallback(num: number) {\r\n        this._durationBeforeCallback = num;\r\n    }\r\n\r\n    get aceEditor() {\r\n        return this.editor;\r\n    }\r\n}\r\n"]}