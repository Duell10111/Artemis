import { Directive, ElementRef, HostListener, Input, Renderer2, NgModule } from '@angular/core';

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes} checked by tsc
 */
import * as ɵngcc0 from '@angular/core';
class AngularFittextDirective {
    /**
     * @param {?} el
     * @param {?} renderer
     */
    constructor(el, renderer) {
        this.el = el;
        this.renderer = renderer;
        this.fittext = true;
        this.compression = 1;
        this.activateOnResize = true;
        this.minFontSize = 0;
        this.maxFontSize = Number.POSITIVE_INFINITY;
        this.delay = 100;
        this.fontUnit = 'px';
        this.calcSize = 10;
        this.onWindowResize = () => {
            if (this.activateOnResize) {
                this.setFontSize();
            }
        };
        this.setFontSize = () => {
            this.resizeTimeout = setTimeout((() => {
                if (this.fittextElement.offsetHeight * this.fittextElement.offsetWidth !== 0) {
                    // reset to default
                    this.setStyles(this.calcSize, 1, 'inline-block');
                    // set new
                    this.setStyles(this.calculateNewFontSize(), this.lineHeight, this.display);
                }
            }).bind(this), this.delay);
        };
        this.calculateNewFontSize = () => {
            const /** @type {?} */ ratio = (this.calcSize * this.newlines) / this.fittextElement.offsetWidth / this.newlines;
            return Math.max(Math.min((this.fittextParent.offsetWidth -
                (parseFloat(getComputedStyle(this.fittextParent).paddingLeft) +
                    parseFloat(getComputedStyle(this.fittextParent).paddingRight)) -
                6) *
                ratio *
                this.compression, this.fittextMaxFontSize), this.fittextMinFontSize);
        };
        this.setStyles = (fontSize, lineHeight, display) => {
            this.renderer.setStyle(this.fittextElement, 'fontSize', fontSize.toString() + this.fontUnit);
            this.renderer.setStyle(this.fittextElement, 'lineHeight', lineHeight.toString());
            this.renderer.setStyle(this.fittextElement, 'display', display);
        };
        this.fittextElement = el.nativeElement;
        this.fittextParent = this.fittextElement.parentElement;
        this.computed = window.getComputedStyle(this.fittextElement);
        this.newlines = this.fittextElement.childElementCount > 0 ? this.fittextElement.childElementCount : 1;
        this.lineHeight = this.computed['line-height'];
        this.display = this.computed['display'];
    }
    /**
     * @return {?}
     */
    ngOnInit() {
        this.fittextMinFontSize = this.minFontSize === 'inherit' ? this.computed['font-size'] : this.minFontSize;
        this.fittextMaxFontSize = this.maxFontSize === 'inherit' ? this.computed['font-size'] : this.maxFontSize;
    }
    /**
     * @return {?}
     */
    ngAfterViewInit() {
        this.setFontSize();
    }
    /**
     * @param {?} changes
     * @return {?}
     */
    ngOnChanges(changes) {
        if (changes['compression'] && !changes['compression'].firstChange) {
            this.setFontSize();
        }
        if (changes['ngModel']) {
            this.fittextElement.innerHTML = this.ngModel;
            this.setFontSize();
        }
    }
}
AngularFittextDirective.ɵfac = function AngularFittextDirective_Factory(t) { return new (t || AngularFittextDirective)(ɵngcc0.ɵɵdirectiveInject(ɵngcc0.ElementRef), ɵngcc0.ɵɵdirectiveInject(ɵngcc0.Renderer2)); };
AngularFittextDirective.ɵdir = ɵngcc0.ɵɵdefineDirective({ type: AngularFittextDirective, selectors: [["", "fittext", ""]], hostBindings: function AngularFittextDirective_HostBindings(rf, ctx) { if (rf & 1) {
        ɵngcc0.ɵɵlistener("resize", function AngularFittextDirective_resize_HostBindingHandler() { return ctx.onWindowResize(); }, false, ɵngcc0.ɵɵresolveWindow);
    } }, inputs: { fittext: "fittext", compression: "compression", activateOnResize: "activateOnResize", minFontSize: "minFontSize", maxFontSize: "maxFontSize", delay: "delay", fontUnit: "fontUnit", ngModel: "ngModel" }, features: [ɵngcc0.ɵɵNgOnChangesFeature] });
/** @nocollapse */
AngularFittextDirective.ctorParameters = () => [
    { type: ElementRef, },
    { type: Renderer2, },
];
AngularFittextDirective.propDecorators = {
    "fittext": [{ type: Input },],
    "compression": [{ type: Input },],
    "activateOnResize": [{ type: Input },],
    "minFontSize": [{ type: Input },],
    "maxFontSize": [{ type: Input },],
    "delay": [{ type: Input },],
    "ngModel": [{ type: Input },],
    "fontUnit": [{ type: Input },],
    "onWindowResize": [{ type: HostListener, args: ['window:resize',] },],
};
/*@__PURE__*/ (function () { ɵngcc0.ɵsetClassMetadata(AngularFittextDirective, [{
        type: Directive,
        args: [{
                selector: '[fittext]'
            }]
    }], function () { return [{ type: ɵngcc0.ElementRef }, { type: ɵngcc0.Renderer2 }]; }, { fittext: [{
            type: Input
        }], compression: [{
            type: Input
        }], activateOnResize: [{
            type: Input
        }], minFontSize: [{
            type: Input
        }], maxFontSize: [{
            type: Input
        }], delay: [{
            type: Input
        }], fontUnit: [{
            type: Input
        }], onWindowResize: [{
            type: HostListener,
            args: ['window:resize']
        }], ngModel: [{
            type: Input
        }] }); })();

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes} checked by tsc
 */
class AngularFittextModule {
}
AngularFittextModule.ɵmod = ɵngcc0.ɵɵdefineNgModule({ type: AngularFittextModule });
AngularFittextModule.ɵinj = ɵngcc0.ɵɵdefineInjector({ factory: function AngularFittextModule_Factory(t) { return new (t || AngularFittextModule)(); } });
(function () { (typeof ngJitMode === "undefined" || ngJitMode) && ɵngcc0.ɵɵsetNgModuleScope(AngularFittextModule, { declarations: [AngularFittextDirective], exports: [AngularFittextDirective] }); })();
/*@__PURE__*/ (function () { ɵngcc0.ɵsetClassMetadata(AngularFittextModule, [{
        type: NgModule,
        args: [{
                declarations: [
                    AngularFittextDirective
                ],
                exports: [
                    AngularFittextDirective
                ]
            }]
    }], null, null); })();

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes} checked by tsc
 */

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes} checked by tsc
 */

export { AngularFittextModule, AngularFittextDirective };

//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYW5ndWxhci1maXR0ZXh0LmpzIiwic291cmNlcyI6WyJuZzovYW5ndWxhci1maXR0ZXh0L3NyYy9hbmd1bGFyLWZpdHRleHQuZGlyZWN0aXZlLnRzIiwibmc6L2FuZ3VsYXItZml0dGV4dC9zcmMvYW5ndWxhci1maXR0ZXh0Lm1vZHVsZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7O0FBQUE7QUFBZ0M7QUFBUTtBQUFxQjtBQUEyQjtBQUFRLElBMkI5RixZQUNVLElBQ0E7QUFBWSxRQURaLE9BQUUsR0FBRixFQUFFO0FBQUUsUUFDSixhQUFRLEdBQVIsUUFBUTtBQUFFLHVCQXRCQSxJQUFJO0FBQzFCLDJCQUEwQixDQUFDO0FBQzNCLGdDQUErQixJQUFJO0FBQ25DLDJCQUE4QyxDQUFDO0FBQy9DLDJCQUE4QyxNQUFNLENBQUMsaUJBQWlCO0FBQ3RFLHFCQUFvQixHQUFHO0FBQ3ZCLHdCQUM2QyxJQUFJO0FBQ2pELHdCQVNxQixFQUFFO0FBQ3ZCLDhCQWUwQjtBQUFRLFlBQzlCLElBQUksSUFBSSxDQUFDLGdCQUFnQixFQUFFO0FBQy9CLGdCQUFNLElBQUksQ0FBQyxXQUFXLEVBQUUsQ0FBQztBQUN6QixhQUFLO0FBQ0wsU0FBRztBQUNILDJCQW9Cd0I7QUFBUSxZQUM1QixJQUFJLENBQUMsYUFBYSxHQUFHLFVBQVUsQ0FDN0IsQ0FBQztBQUNQLGdCQUFRLElBQUksSUFBSSxDQUFDLGNBQWMsQ0FBQyxZQUFZLEdBQUcsSUFBSSxDQUFDLGNBQWMsQ0FBQyxXQUFXLEtBQUssQ0FBQyxFQUFFO0FBQ3RGO0FBQ1Usb0JBQUEsSUFBSSxDQUFDLFNBQVMsQ0FBQyxJQUFJLENBQUMsUUFBUSxFQUFFLENBQUMsRUFBRSxjQUFjLENBQUMsQ0FBQztBQUMzRDtBQUNVLG9CQUFBLElBQUksQ0FBQyxTQUFTLENBQUMsSUFBSSxDQUFDLG9CQUFvQixFQUFFLEVBQUUsSUFBSSxDQUFDLFVBQVUsRUFBRSxJQUFJLENBQUMsT0FBTyxDQUFDLENBQUM7QUFDckYsaUJB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LEFBQUEsQUFFQSxBQUFBLEFBVUEsQUFBQSxBQWdCQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQ0EsQUFxQkEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFFQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBRUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUNBLEFBRUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBRUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFDQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQ0EsQUFFQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFyRUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQVNBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBR0EsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUdBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQTVEQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBSkEsQUFBQSxBQUFBLEFBQUEsQUFPQSxBQUFBLEFBQ0EsQUFBQSxBQUNBLEFBQUEsQUFDQSxBQUFBLEFBQ0EsQUFBQSxBQUNBLEFBQUEsQUFDQSxBQUFBLEFBQ0EsQUFBQSxBQXlCQSxBQUFBLEFBQUEsQUFBQSxBQ3ZDQSxBQUlBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFDQSxBQUNBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFDQSxBQUNBIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtBZnRlclZpZXdJbml0LCBEaXJlY3RpdmUsIEVsZW1lbnRSZWYsIEhvc3RMaXN0ZW5lciwgSW5wdXQsIE9uQ2hhbmdlcywgT25Jbml0LCBSZW5kZXJlcjIsIFNpbXBsZUNoYW5nZXN9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuXG5ARGlyZWN0aXZlKHtcbiAgc2VsZWN0b3I6ICdbZml0dGV4dF0nXG59KVxuZXhwb3J0IGNsYXNzIEFuZ3VsYXJGaXR0ZXh0RGlyZWN0aXZlIGltcGxlbWVudHMgQWZ0ZXJWaWV3SW5pdCwgT25Jbml0LCBPbkNoYW5nZXMge1xuXG4gIEBJbnB1dCgpIGZpdHRleHQ/ID0gdHJ1ZTtcbiAgQElucHV0KCkgY29tcHJlc3Npb24/ID0gMTtcbiAgQElucHV0KCkgYWN0aXZhdGVPblJlc2l6ZT8gPSB0cnVlO1xuICBASW5wdXQoKSBtaW5Gb250U2l6ZT86IG51bWJlciB8ICdpbmhlcml0JyA9IDA7XG4gIEBJbnB1dCgpIG1heEZvbnRTaXplPzogbnVtYmVyIHwgJ2luaGVyaXQnID0gTnVtYmVyLlBPU0lUSVZFX0lORklOSVRZO1xuICBASW5wdXQoKSBkZWxheT8gPSAxMDA7XG4gIEBJbnB1dCgpIG5nTW9kZWw7XG4gIEBJbnB1dCgpIGZvbnRVbml0PzogJ3B4JyB8ICdlbScgfCBzdHJpbmcgPSAncHgnO1xuXG4gIHByaXZhdGUgZml0dGV4dFBhcmVudDogSFRNTEVsZW1lbnQ7XG4gIHByaXZhdGUgZml0dGV4dEVsZW1lbnQ6IEhUTUxFbGVtZW50O1xuICBwcml2YXRlIGZpdHRleHRNaW5Gb250U2l6ZTogbnVtYmVyO1xuICBwcml2YXRlIGZpdHRleHRNYXhGb250U2l6ZTogbnVtYmVyO1xuICBwcml2YXRlIGNvbXB1dGVkOiBDU1NTdHlsZURlY2xhcmF0aW9uO1xuICBwcml2YXRlIG5ld2xpbmVzOiBudW1iZXI7XG4gIHByaXZhdGUgbGluZUhlaWdodDogc3RyaW5nO1xuICBwcml2YXRlIGRpc3BsYXk6IHN0cmluZztcbiAgcHJpdmF0ZSBjYWxjU2l6ZSA9IDEwO1xuICBwcml2YXRlIHJlc2l6ZVRpbWVvdXQ6IG51bWJlcjtcblxuICBjb25zdHJ1Y3RvcihcbiAgICBwcml2YXRlIGVsOiBFbGVtZW50UmVmLFxuICAgIHByaXZhdGUgcmVuZGVyZXI6IFJlbmRlcmVyMlxuICApIHtcbiAgICB0aGlzLmZpdHRleHRFbGVtZW50ID0gZWwubmF0aXZlRWxlbWVudDtcbiAgICB0aGlzLmZpdHRleHRQYXJlbnQgPSB0aGlzLmZpdHRleHRFbGVtZW50LnBhcmVudEVsZW1lbnQ7XG4gICAgdGhpcy5jb21wdXRlZCA9IHdpbmRvdy5nZXRDb21wdXRlZFN0eWxlKHRoaXMuZml0dGV4dEVsZW1lbnQpO1xuICAgIHRoaXMubmV3bGluZXMgPSB0aGlzLmZpdHRleHRFbGVtZW50LmNoaWxkRWxlbWVudENvdW50ID4gMCA/IHRoaXMuZml0dGV4dEVsZW1lbnQuY2hpbGRFbGVtZW50Q291bnQgOiAxO1xuICAgIHRoaXMubGluZUhlaWdodCA9IHRoaXMuY29tcHV0ZWRbJ2xpbmUtaGVpZ2h0J107XG4gICAgdGhpcy5kaXNwbGF5ID0gdGhpcy5jb21wdXRlZFsnZGlzcGxheSddO1xuICB9XG5cbiAgQEhvc3RMaXN0ZW5lcignd2luZG93OnJlc2l6ZScpXG4gIHB1YmxpYyBvbldpbmRvd1Jlc2l6ZSA9ICgpOiB2b2lkID0+IHtcbiAgICBpZiAodGhpcy5hY3RpdmF0ZU9uUmVzaXplKSB7XG4gICAgICB0aGlzLnNldEZvbnRTaXplKCk7XG4gICAgfVxuICB9O1xuXG4gIHB1YmxpYyBuZ09uSW5pdCgpIHtcbiAgICB0aGlzLmZpdHRleHRNaW5Gb250U2l6ZSA9IHRoaXMubWluRm9udFNpemUgPT09ICdpbmhlcml0JyA/IHRoaXMuY29tcHV0ZWRbJ2ZvbnQtc2l6ZSddIDogdGhpcy5taW5Gb250U2l6ZTtcbiAgICB0aGlzLmZpdHRleHRNYXhGb250U2l6ZSA9IHRoaXMubWF4Rm9udFNpemUgPT09ICdpbmhlcml0JyA/IHRoaXMuY29tcHV0ZWRbJ2ZvbnQtc2l6ZSddIDogdGhpcy5tYXhGb250U2l6ZTtcbiAgfVxuXG4gIHB1YmxpYyBuZ0FmdGVyVmlld0luaXQoKSB7XG4gICAgdGhpcy5zZXRGb250U2l6ZSgpO1xuICB9XG5cbiAgcHVibGljIG5nT25DaGFuZ2VzKGNoYW5nZXM6IFNpbXBsZUNoYW5nZXMpIHtcbiAgICBpZiAoY2hhbmdlc1snY29tcHJlc3Npb24nXSAmJiAhY2hhbmdlc1snY29tcHJlc3Npb24nXS5maXJzdENoYW5nZSkge1xuICAgICAgdGhpcy5zZXRGb250U2l6ZSgpO1xuICAgIH1cbiAgICBpZiAoY2hhbmdlc1snbmdNb2RlbCddKSB7XG4gICAgICB0aGlzLmZpdHRleHRFbGVtZW50LmlubmVySFRNTCA9IHRoaXMubmdNb2RlbDtcbiAgICAgIHRoaXMuc2V0Rm9udFNpemUoKTtcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIHNldEZvbnRTaXplID0gKCk6IHZvaWQgPT4ge1xuICAgIHRoaXMucmVzaXplVGltZW91dCA9IHNldFRpbWVvdXQoXG4gICAgICAoKCkgPT4ge1xuICAgICAgICBpZiAodGhpcy5maXR0ZXh0RWxlbWVudC5vZmZzZXRIZWlnaHQgKiB0aGlzLmZpdHRleHRFbGVtZW50Lm9mZnNldFdpZHRoICE9PSAwKSB7XG4gICAgICAgICAgLy8gcmVzZXQgdG8gZGVmYXVsdFxuICAgICAgICAgIHRoaXMuc2V0U3R5bGVzKHRoaXMuY2FsY1NpemUsIDEsICdpbmxpbmUtYmxvY2snKTtcbiAgICAgICAgICAvLyBzZXQgbmV3XG4gICAgICAgICAgdGhpcy5zZXRTdHlsZXModGhpcy5jYWxjdWxhdGVOZXdGb250U2l6ZSgpLCB0aGlzLmxpbmVIZWlnaHQsIHRoaXMuZGlzcGxheSk7XG4gICAgICAgIH1cbiAgICAgIH0pLmJpbmQodGhpcyksXG4gICAgICB0aGlzLmRlbGF5XG4gICAgKTtcbiAgfTtcblxuICBwcml2YXRlIGNhbGN1bGF0ZU5ld0ZvbnRTaXplID0gKCk6IG51bWJlciA9PiB7XG4gICAgY29uc3QgcmF0aW8gPSAodGhpcy5jYWxjU2l6ZSAqIHRoaXMubmV3bGluZXMpIC8gdGhpcy5maXR0ZXh0RWxlbWVudC5vZmZzZXRXaWR0aCAvIHRoaXMubmV3bGluZXM7XG5cbiAgICByZXR1cm4gTWF0aC5tYXgoXG4gICAgICBNYXRoLm1pbihcbiAgICAgICAgKHRoaXMuZml0dGV4dFBhcmVudC5vZmZzZXRXaWR0aCAtXG4gICAgICAgICAgKHBhcnNlRmxvYXQoZ2V0Q29tcHV0ZWRTdHlsZSh0aGlzLmZpdHRleHRQYXJlbnQpLnBhZGRpbmdMZWZ0KSArXG4gICAgICAgICAgICBwYXJzZUZsb2F0KGdldENvbXB1dGVkU3R5bGUodGhpcy5maXR0ZXh0UGFyZW50KS5wYWRkaW5nUmlnaHQpKSAtXG4gICAgICAgICAgNikgKlxuICAgICAgICByYXRpbyAqXG4gICAgICAgIHRoaXMuY29tcHJlc3Npb24sXG4gICAgICAgIHRoaXMuZml0dGV4dE1heEZvbnRTaXplXG4gICAgICApLFxuICAgICAgdGhpcy5maXR0ZXh0TWluRm9udFNpemVcbiAgICApO1xuICB9O1xuXG4gIHByaXZhdGUgc2V0U3R5bGVzID0gKGZvbnRTaXplOiBudW1iZXIsIGxpbmVIZWlnaHQ6IG51bWJlciB8IHN0cmluZywgZGlzcGxheTogc3RyaW5nKTogdm9pZCA9PiB7XG4gICAgdGhpcy5yZW5kZXJlci5zZXRTdHlsZSh0aGlzLmZpdHRleHRFbGVtZW50LCAnZm9udFNpemUnLCBmb250U2l6ZS50b1N0cmluZygpICsgdGhpcy5mb250VW5pdCk7XG4gICAgdGhpcy5yZW5kZXJlci5zZXRTdHlsZSh0aGlzLmZpdHRleHRFbGVtZW50LCAnbGluZUhlaWdodCcsIGxpbmVIZWlnaHQudG9TdHJpbmcoKSk7XG4gICAgdGhpcy5yZW5kZXJlci5zZXRTdHlsZSh0aGlzLmZpdHRleHRFbGVtZW50LCAnZGlzcGxheScsIGRpc3BsYXkpO1xuICB9O1xufVxuIiwiaW1wb3J0IHtOZ01vZHVsZX0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQge0FuZ3VsYXJGaXR0ZXh0RGlyZWN0aXZlfSBmcm9tICcuL2FuZ3VsYXItZml0dGV4dC5kaXJlY3RpdmUnO1xuXG5cbkBOZ01vZHVsZSh7XG4gIGRlY2xhcmF0aW9uczogW1xuICAgIEFuZ3VsYXJGaXR0ZXh0RGlyZWN0aXZlXG4gIF0sXG4gIGV4cG9ydHM6IFtcbiAgICBBbmd1bGFyRml0dGV4dERpcmVjdGl2ZVxuICBdXG59KVxuXG5leHBvcnQgY2xhc3MgQW5ndWxhckZpdHRleHRNb2R1bGUge1xufVxuIl19